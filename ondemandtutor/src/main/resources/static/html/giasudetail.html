<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../assets/css/giasudetail.css">
    <link rel="stylesheet" href="../assets/css/header.css">
    <link rel="stylesheet" href="../assets/css/footer.css">
    <link rel="stylesheet" href="../asset/fonts/fontawesome-free-6.5.2-web/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <title>Document</title>
</head>
<body>
<header class="header">
    <!--test-->
    <div class="logo-container">
        <a class="img-logo" href="../html/home.html">
            <!-- <img class="logo" src="../assets/img/logo/snapedit_17228353747082.png" alt=""> -->
            <p class="text">LEARN TOgetHER</p>
        </a>
    </div>

    <div class="navbar-container">
        <a class="nav-box" href="../html/gioithieu.html">GIỚI THIỆU</a>
        <a class="nav-box" href="./tutor.html">GIA SƯ</a>
        <a class="nav-box" href="./dichvulist.html">DỊCH VỤ</a>
        <a class="nav-box hidden" href="./taodichvu.html">TẠO DỊCH VỤ</a>
    </div>

    <div class="login-search-container">
        <div class="message-container" id="messageContainer">
            <a href="messages.html" class="message-link">
                <i class="message-icon fa-regular fa-message"></i>
                <span class="message-count" id="messageCount">0</span>
            </a>
        </div>

        <div class="login-container">
            <a href="modal.html" class="search-link">
                <button id="loginButton" class="login-button">Đăng nhập</button>
            </a>
            <div class="user-info" id="userInfo">
                <span id="usernameDisplay"></span>
                <img id="avatar" src="https://th.bing.com/th/id/OIP.MaDrjtmPQGzKiLHrHEPfFAHaHa?w=199&h=199&c=7&r=0&o=5&pid=1.7" alt="Avatar" class="avatar">
                <div id="userDropdown" class="user-dropdown">
                    <a href="editprofile.html" class="sub-menu-link">
                        <img src="../assets/img/header/profile.png" alt="">
                        <p>Thông tin cá nhân</p>
                        <i class="fa-solid fa-chevron-right"></i>
                    </a>
                    <a href="#" id="logoutButton" class="sub-menu-link">
                        <img src="../assets/img/header/logout.png" alt="">
                        <p>Đăng xuất</p>
                        <i class="fa-solid fa-chevron-right"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
</header>

<div class="tutor-container">
    <div class="rating-hire-price-container">
        <div class="tutor-video">
            <iframe class="videoo" width="300" height="200" src="https://www.youtube.com/embed/bg6wwEJ-HjA?start=12" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>


        </div>

        <!--        <div class="rating">-->
        <!--            <span data-rating="5">★</span>-->
        <!--            <span data-rating="4">★</span>-->
        <!--            <span data-rating="3">★</span>-->
        <!--            <span data-rating="2">★</span>-->
        <!--            <span data-rating="1">★</span>-->
        <!--        </div>-->
        <div class="tutor-button">
            <button class="nut">yêu cầu thuê</button>
            <a href=""><button class="nut">gửi tin nhắn</button></a>
        </div>

    </div>
    <div class="container-div">

        <div class="avatar-name-contaier">
            <img id="avatar-a" class="avatar-a" src="https://resources.churchofchrist1830.org/wp-content/uploads/2024/02/generic-bio-avatar.png" alt="">
            <div class="name-tutor">
                <h4> <span id="tutorName"></span> </h4>
                <p id="subjectId">monhoc</p>

            </div>
        </div>

        <div class="about-service-container">
            <h1 >Mô tả</h1>
            <div id="bio" class="thongtin"><p>thong tin</p></div>
        </div>
        <!-- <div class="view-schedule-container">
            <h1>View Schedule</h1>
            <table id="scheduleTable">
                <thead>
                    <tr>
                        <th>Day</th>
                        <th>Times</th>
                    </tr>
                </thead>
                <tbody>

                </tbody>
            </table>
        </div> -->
        <div class="write-comment">
            <div class="rating">
                <input type="radio" name="rating" id="star5" value="5">
                <label for="star5" title="5 stars">&#9733;</label>
                <input type="radio" name="rating" id="star4" value="4">
                <label for="star4" title="4 stars">&#9733;</label>
                <input type="radio" name="rating" id="star3" value="3">
                <label for="star3" title="3 stars">&#9733;</label>
                <input type="radio" name="rating" id="star2" value="2">
                <label for="star2" title="2 stars">&#9733;</label>
                <input type="radio" name="rating" id="star1" value="1">
                <label for="star1" title="1 star">&#9733;</label>
            </div>

            <div class="but-con">
            <input type="text" id="respone" name="priceOfSession" value="" placeholder="viết phản hồi...">
            <button class="send-button" type="submit"><i class="fas fa-paper-plane"></i>
            </button>
        </div>
        <div class="respone-tutor-container">

            <div class="comment-user">
                <div class="user-info">
                    <div class="user-avar">
                        <img src="https://resources.churchofchrist1830.org/wp-content/uploads/2024/02/generic-bio-avatar.png" >
                    </div>
                    <div class="user-name">
                        <strong>name</strong>
                        <span>date</span>
                    </div>

                </div>
                <div class="rating">
                    <span data-rating="5">★</span>
                    <span data-rating="4">★</span>
                    <span data-rating="3">★</span>
                    <span data-rating="2">★</span>
                    <span data-rating="1">★</span>
                </div>

            </div>

            <div class="client-comment">
                <p>Oh great, I just started learning web programming languages. So lucky to know your channel. Hopefully in the future you can create many useful videos like this for everyone learning programming </p>
            </div>
        </div>

    </div>

</div>
</div>
<footer>
    <div class="footer-container">
        <div class="socials">
            <a href=""><i class="fa-brands fa-facebook"></i></a>
            <a href=""><i class="fa-brands fa-instagram"></i></a>
            <a href=""><i class="fa-brands fa-twitter"></i></a>
            <a href=""><i class="fa-brands fa-google-plus"></i></a>
            <a href=""><i class="fa-brands fa-youtube"></i></a>
        </div>
        <div class="footer-nav">
            <ul>
                <li><a href="">Home</a></li>
                <li><a href="">About</a></li>
                <li><a href="">Contact Us</a></li>
            </ul>
        </div>
    </div>
    <div class="footer-bottom">
        <p>Copyright &copy;2024; Designed by <span class="designer">DL</span></p>
    </div>

</footer>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const token = localStorage.getItem('token');

        console.log(token); // Check if the token exists and is correct

        const urlParams = new URLSearchParams(window.location.search);
        const tutorId = urlParams.get('id');  // Get the ID from the URL

        if (tutorId) {
            fetch(`http://localhost:8080/v1/tutor-services/tutor/${tutorId}`, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${token}`
                }
            })
                .then(response => response.json())
                .then(data => {
                    console.log('API Response:', data);  // Check if the response structure is as expected

                    const uniqueSubjects = new Set();

                    // Assuming `data` is an array of subjects
                    data.result.forEach(item => {
                        if (item.nameSubject) {
                            uniqueSubjects.add(item.nameSubject);
                        }
                    });

                    // Convert the Set to an array and join the subjects into a single string
                    const subjectsArray = Array.from(uniqueSubjects);
                    const subjectsText = subjectsArray.join(', ');
                    // document.querySelector('#subjectId').innerHTML = `${data.result[i].nameSubject}` || '';
                    document.querySelector('#subjectId').innerHTML = subjectsText || 'No subjects available';





                })
                .catch(error => console.error('Error fetching tutor details:', error));

        }


    });

</script>
<script>
    async function getMyInfo() {
        try {
            const token = localStorage.getItem('token');
            const urlParams = new URLSearchParams(window.location.search);
            const tutorId = urlParams.get('id');

            {
                const response = await fetch(`http://localhost:8080/v1/tutor/${tutorId}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                        // Thêm Authorization header nếu cần thiết
                    }
                });

                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }

                const data = await response.json();
                console.log("logggg",data);
                // Cập nhật thông tin cá nhân lên giao diện
                document.querySelector('#tutorName').innerHTML = `${data.result.name}` || '';
                document.querySelector('#bio').innerHTML = `${data.result.bio}` || '';

                const profilePicElement = document.getElementById('avatar-a');


                if (data.result.imgUrl) { // Kiểm tra nếu có URL của hình đại diện
                    profilePicElement.src = data.result.imgUrl;
                } else {
                    profilePicElement.src = 'https://th.bing.com/th/id/OIP.MaDrjtmPQGzKiLHrHEPfFAHaHa?w=199&h=199&c=7&r=0&o=5&pid=1.7';
                }
            }



        } catch (error) {
            console.error('There was a problem with the fetch operation:', error);
        }



    }

    // Gọi hàm getMyInfo khi trang được tải
    window.onload = getMyInfo;
</script>
<script>
document.querySelectorAll('.rating input[type="radio"]').forEach(radio => {
    radio.addEventListener('change', () => {
        let ratingValue = document.querySelector('input[name="rating"]:checked').value;
        console.log('Đánh giá sao:', ratingValue);
        // Bạn có thể gửi giá trị ratingValue tới server ở đây nếu cần.
    });
});

    document.querySelector('.nut').addEventListener('click', function () {
        const tutorId = new URLSearchParams(window.location.search).get('id');
        if (tutorId) {
            window.location.href = `tutorservice.html?tutorId=${tutorId}`;
        } else {
            window.location.href = 'tutorservice.html';
        }
    });
</script>
<!--<script>-->
<!--    const token = localStorage.getItem('token');-->
<!--    const studentId = localStorage.getItem('id');-->
<!--    console.log(studentId);-->
<!--    const urlParams = new URLSearchParams(window.location.search);-->
<!--    const tutorId = urlParams.get('id');-->

<!--    if (tutorId) {-->
<!--        fetch(`http://localhost:8080/v1/booking/getBooking`, {-->
<!--            method: 'POST',-->
<!--            headers: {-->
<!--                'Content-Type': 'application/json',-->
<!--                'Authorization': `Bearer ${token}`-->
<!--            },-->
<!--            body: JSON.stringify({-->
<!--                studentId: studentId,-->
<!--                tutorId: tutorId-->
<!--            })-->
<!--        })-->
<!--            .then(response => response.json())-->
<!--            .then(hasBooking => {-->
<!--                console.log(hasBooking);-->
<!--                if (hasBooking!=null) {-->
<!--                    // Show the review section if booking exists-->
<!--                    document.querySelector('.write-comment').style.display = 'block';-->

<!--                    // Add event listener for review submission-->
<!--                    document.querySelector('.send-button').addEventListener('click', () => {-->
<!--                        const rating = document.querySelector('input[name="rating"]:checked').value;-->
<!--                        const comment = document.getElementById('response').value;-->

<!--                        // Check if rating and comment are provided-->
<!--                        if (!rating || !comment.trim()) {-->
<!--                            alert('Vui lòng đánh giá và nhập bình luận.');-->
<!--                            return;-->
<!--                        }-->

<!--                        // Submit the review-->
<!--                        fetch('http://localhost:8080/v1/reviews', {-->
<!--                            method: 'POST',-->
<!--                            headers: {-->
<!--                                'Content-Type': 'application/json',-->
<!--                                'Authorization': `Bearer ${token}`-->
<!--                            },-->
<!--                            body: JSON.stringify({-->
<!--                                rating: parseFloat(rating),-->
<!--                                comment: comment,-->
<!--                                bookingId: hasBooking.bookingId // Assuming bookingId is returned in the response-->
<!--                            })-->
<!--                        })-->
<!--                            .then(response => response.json())-->
<!--                            .then(data => {-->
<!--                                console.log('Review submitted successfully:', data);-->
<!--                                // Reload the page or update the reviews section dynamically-->
<!--                                location.reload(); // Refresh page to show new review-->
<!--                            })-->
<!--                            .catch(error => console.error('Error submitting review:', error));-->
<!--                    });-->
<!--                } else {-->
<!--                    // Hide the review section if no booking is found-->
<!--                    document.querySelector('.write-comment').style.display = 'none';-->
<!--                    alert('Bạn phải đặt khóa học với giảng viên này để có thể bình luận.');-->
<!--                }-->
<!--            })-->
<!--            .catch(error => console.error('Error checking booking:', error));-->
<!--    } else {-->
<!--        console.error('Tutor ID is missing.');-->
<!--    }-->

<!--</script>-->
<script src="../js/header.js"></script>
</body>
</html>
